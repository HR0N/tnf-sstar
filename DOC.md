## Авторизация

Игра должна подхватить cookie со страницы, на которой она находится. Все дальнейшие запросы к API делаются с этим cookie.

## Информация об игроке

GET-запрос на `/api/me` возвратит JSON-объект со следующего вида:

```json
{
  "balances": {
    // Количество монет
    "coins": 250,
    // Количество кристалов
    "crystals": 1000,
    // Количество энергии
    "energy": 100
  },
  // Количество лутбоксов с редкими заводами
  "crystalFarmBoxes": 0,
  // Количество карточек с обычными заводами
  "crystalFarmCards": 0,
  // Сколько заводов построено игроком
  "crystalFarmsBuilt": 0,
  // Когда закончится текущая экспедиция
  "expeditionEndsOn": "2022-04-20T13:22:50.186Z",
  // Количество доступных на сегодня экспедиций
  "expeditionLeftToday": 3,
  // Количество зондов
  "expeditionShips": 1,
  // Построен ли научный центр?
  "isResearchCenterBuilt": true,
  // Количество карточек с электростанциями
  "powerPlantCards": 0,
  // Сколько электростанций построено игроком
  "powerPlantsBuilt": 2,
}
```

## Строительство

POST-запрос на `/api/building` c JSON-объектом следующего вида:

```json
{
  // Научный центр
  "type": "researchCenter",
  // Электростанция
  // "type": "powerPlant",
  // Зонд
  // "type": "expeditionShip",
  // Завод
  // "type": "crystalFarm",
}
```

Электростанции и заводы можно строить бесплатно, если соответствующая карта есть в инвентаре, для этого нужно добавить поле `useCard: true` в JSON-объект.

Если объект построен успешно, будет возвращен ответ со статусом *201*, иначе возвратится JSON-объект c текстом ошибки в поле `message`.

## Экспедиции

POST-запрос на `/api/expedition` отправит зонд в экспедицию. Аналогичный GET-запрос возвратит информацию о текущей экспедиции.

### Экспедиция ещё в процессе

```json
{
  // Когда экспедиция закончится
  expeditionEndsOn: "2022-04-20T13:16:09.995Z"
}
```

### Экспедиция закончена

```json
{
  // Результат экспедиции
  result: {
    // Кристалы
    reward: "crystals",
    // Количество полученных кристалов
    amount: 3
    // Лутбокс с редким заводом
    // reward: "crystalFarmBox",
    // Зонд потерян
    // reward: "lostExpeditionShip",
    // Ничего
    // reward: "nothing",
    // Новый зонд
    // reward: "expeditionShip",
    // Карточка электростанции
    // reward: "powerPlantCard",
    // Карточка обычного завода
    // reward: "crystalFarmCard",
  }
}
```

## Обмен

POST-запрос на `/api/swap` c JSON-объектом следующего вида

### Кристалы на токены

```json
{
  "type": "sell",
  "amount": 2
}

### Токены на кристалы

Для реализации этого направления обмена требуется подключить игру к кошельку MetaMask, и подписать [разрешение на списание токенов](https://eips.ethereum.org/EIPS/eip-2612)

```json
{
  "type": "buy",
  "owner": "0x9EE5e175D09895b8E1E28c22b961345e1dF4B5aE",
  "spender": "0xE1B48CddD97Fa4b2F960Ca52A66CeF8f1f8A58A5",
  "value": "",
  "deadline": 1589205127399,
  "v": 27,
  "r": "0xc225220de6c6f5a829c07bf07444435619c98ac95fb5ce82205bc9be1def858b",
  "s": "0x5924bfb22181c58e4ec4bc26d42ae5b4edb53ffebf9045cad2e275baab4915ba"
}